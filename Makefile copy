# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    Makefile copy                                      :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: lgoncalv <lgoncalv@student.42sp.org.br>    +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2022/04/24 11:45:10 by lgoncalv          #+#    #+#              #
#    Updated: 2022/05/14 18:53:57 by lgoncalv         ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

# COMPILER
CC				= gcc

# FLAGS
CFLAGS			= -Wall -Wextra -Werror
FTFLAGS			= -L $(LIBS_PATH) -lft
MLXFLAGS		= -L $(MLX_PATH) -lmlx -lXext -lX11
INCLUDES		= -I $(INCLUDES_PATH) -I $(MLX_PATH)

# PATHS
INCLUDES_PATH	= ./includes
SOURCES_PATH	= ./sources
OBJS_PATH		= ./objects
LIBS_PATH		= ./libs
MLX_PATH		= $(LIBS_PATH)/minilibx

# COMMANDS
RM				= /bin/rm -f

# NAMES
NAME			= so_long
MLX				= $(MLX_PATH)/libmlx.a
LIBFT			= $(LIBS_PATH)/libft.a
SO_LONG			= so_long.h

# SOURCES
SRCS			= main.c \
				sl_error_handler.c
SRCS			:= $(addprefix $(SOURCES_PATH)/, $(SRCS))
SO_LONG			:= $(addprefix $(INCLUDES_PATH)/, $(SO_LONG))

# OBJECTS
OBJS			:= $(addprefix $(OBJS_PATH)/, $(SRCS:.c=.o))

# PATTERN RULE
$(OBJS_PATH)/%.o : $(SOURCES_PATH)/%.c
		$(CC) $(CFLAGS) $(INCLUDES) -c $< -o $@

all:	clear_console $(NAME)

$(NAME): $(MLX) $(OBJS)
	$(CC) $(CFLAGS) $(INCLUDES) $(OBJS) $(LIBFT) $(MLXFLAGS) -o $@

$(MLX):
	$(MAKE) -C $(MLX_PATH)

clean:
	$(MAKE) -C $(MLX_PATH) clean
	$(RM) $(OBJS)

fclean:	clean
	$(RM) $(NAME)

re:	fclean all

clear_console:
	clear

run_clean:	re
	./so_long
	$(RM) $(OBJS)
	
bonus:	all

rebonus: fclean bonus

manminilib:
	man $(MINILIBX_PATH)/man/$(arg)

.PHONY:	all clean fclean re run_clean testing

testing:
	cat $(wildcard $(SOURCES_PATH)/*.c)

# to review:
# $< (takes first argument of dependency?)

# clang main.c -lmlx -lXext -lXll
# clang main.c -L/libraries/minilibx -lmlx -L/libraries/minilibx -lXext -L/libraries/minilibx -lX11
# /usr/bin/ld: cannot find -lmlx
# /usr/bin/ld: cannot find -lx11